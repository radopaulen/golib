<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ODEBND_GSL: /home/bchachua/Programs/Devel/MC++/ODEBND_GSL_1.0/src/ellipsoid.hpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ODEBND_GSL
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('ellipsoid_8hpp.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">ellipsoid.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (C) 2012, 2013 Benoit Chachuat, Imperial College London.</span>
<a name="l00002"></a>00002 <span class="comment">// All Rights Reserved.</span>
<a name="l00003"></a>00003 <span class="comment">// This code is published under the Eclipse Public License.</span>
<a name="l00004"></a>00004 
<a name="l00088"></a>00088 <span class="preprocessor">#ifndef MC__ELLIPSOID_HPP</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">#define MC__ELLIPSOID_HPP</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>
<a name="l00091"></a>00091 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00092"></a>00092 <span class="preprocessor">#include &lt;iomanip&gt;</span>
<a name="l00093"></a>00093 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="preprocessor">#include &quot;mcfunc.hpp&quot;</span>
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="preprocessor">#undef  MC__ELLIPSOID_DEBUG_EIGEN</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">#undef  MC__ELLIPSOID_DEBUG_SQRT</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>
<a name="l00100"></a>00100 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> dsyev_
<a name="l00101"></a>00101 ( <span class="keyword">const</span> <span class="keywordtype">char</span>*jobz, <span class="keyword">const</span> <span class="keywordtype">char</span>*uplo, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*n, <span class="keywordtype">double</span>*a,
<a name="l00102"></a>00102   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*lda, <span class="keywordtype">double</span>*w, <span class="keywordtype">double</span>*work, <span class="keyword">const</span> <span class="keywordtype">int</span>*lwork, <span class="keywordtype">int</span>*info );
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">double</span> dnrm2_
<a name="l00105"></a>00105 ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*n, <span class="keyword">const</span> <span class="keywordtype">double</span>*a, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*incx );
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="keyword">namespace </span>mc
<a name="l00108"></a>00108 {
<a name="l00115"></a><a class="code" href="classmc_1_1Ellipsoid.html">00115</a> <span class="keyword">class </span><a class="code" href="classmc_1_1Ellipsoid.html" title="C++ class for ellipsoidal calculus.">Ellipsoid</a>
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118   <span class="keyword">friend</span> std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;
<a name="l00119"></a>00119     ( std::ostream&amp;, <span class="keyword">const</span> <a class="code" href="classmc_1_1Ellipsoid.html" title="C++ class for ellipsoidal calculus.">Ellipsoid</a>&amp; );
<a name="l00120"></a>00120   
<a name="l00121"></a>00121 <span class="keyword">private</span>:
<a name="l00122"></a>00122 
<a name="l00124"></a>00124   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _n;
<a name="l00126"></a>00126   <span class="keywordtype">double</span> *_p;
<a name="l00128"></a>00128   <span class="keywordtype">double</span> *_Q;
<a name="l00130"></a>00130   <span class="keywordtype">double</span> *_c;
<a name="l00132"></a>00132   std::pair&lt; double*, double* &gt; _eigQ;
<a name="l00134"></a>00134   <span class="keywordtype">double</span> *_sqrtQ;
<a name="l00136"></a>00136   <span class="keywordtype">bool</span> _PSDchecked;
<a name="l00137"></a>00137 
<a name="l00139"></a>00139   <span class="keywordtype">double</span> _diagQ
<a name="l00140"></a>00140     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i ) <span class="keyword">const</span>;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="keyword">public</span>:
<a name="l00143"></a>00143 
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <a class="code" href="classmc_1_1Ellipsoid.html" title="C++ class for ellipsoidal calculus.">Ellipsoid</a>&amp; <span class="keyword">operator</span>+=
<a name="l00149"></a><a class="code" href="group__ELLIPSOID.html#gae83092cdc38cb845da73fb1d110d5e53">00149</a>     ( <span class="keyword">const</span> <span class="keywordtype">double</span> *d )
<a name="l00150"></a>00150     {
<a name="l00151"></a>00151       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;_n; i++ )
<a name="l00152"></a>00152         _c[i] += d[i];
<a name="l00153"></a>00153       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00154"></a>00154     }
<a name="l00156"></a>00156   <a class="code" href="classmc_1_1Ellipsoid.html" title="C++ class for ellipsoidal calculus.">Ellipsoid</a>&amp; <span class="keyword">operator</span>-=
<a name="l00157"></a><a class="code" href="group__ELLIPSOID.html#ga9380769f38254490b1bed3f2db337136">00157</a>     ( <span class="keyword">const</span> <span class="keywordtype">double</span> *d )
<a name="l00158"></a>00158     {
<a name="l00159"></a>00159       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;_n; i++ )
<a name="l00160"></a>00160         _c[i] -= d[i];
<a name="l00161"></a>00161       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 
<a name="l00165"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html">00165</a>   <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html" title="Ellipsoid options.">Options</a>
<a name="l00166"></a>00166   {
<a name="l00168"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a2b406f2e8476a6d7b275fece750e070b">00168</a>     <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a2b406f2e8476a6d7b275fece750e070b" title="Constructor.">Options</a>():
<a name="l00169"></a>00169       <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a>(<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">LOWER</a>), <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a0d18be5224bb202e532e047c994e82ee" title="Whether or not to check positive semi-definiteness of shape matrices (default=false)">PSDCHK</a>(false), <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a368ec5b16a4899f959abb2578c0d0a8b" title="Tolerance for positive semi-definiteness check of shape matrices (default=1e2*mc::machprec())">PSDTOL</a>(machprec()*1e2)
<a name="l00170"></a>00170       {}
<a name="l00172"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5">00172</a>     <span class="keyword">enum</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">SHAPE_MATRIX</a>{
<a name="l00173"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba">00173</a>       <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">LOWER</a>=0,    
<a name="l00174"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3">00174</a>       <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3" title="Upper triangular part of shape matrix stored row-wise.">UPPER</a>    
<a name="l00175"></a>00175     };
<a name="l00177"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109">00177</a>     <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">SHAPE_MATRIX</a> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a>;
<a name="l00179"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a0d18be5224bb202e532e047c994e82ee">00179</a>     <span class="keywordtype">bool</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a0d18be5224bb202e532e047c994e82ee" title="Whether or not to check positive semi-definiteness of shape matrices (default=false)">PSDCHK</a>;
<a name="l00181"></a><a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a368ec5b16a4899f959abb2578c0d0a8b">00181</a>     <span class="keywordtype">double</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a368ec5b16a4899f959abb2578c0d0a8b" title="Tolerance for positive semi-definiteness check of shape matrices (default=1e2*mc::machprec())">PSDTOL</a>;
<a name="l00182"></a>00182   } options;
<a name="l00183"></a>00183 
<a name="l00185"></a><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html">00185</a>   <span class="keyword">class </span><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html" title="Ellipsoid exceptions.">Exceptions</a>
<a name="l00186"></a>00186   {
<a name="l00187"></a>00187   <span class="keyword">public</span>:
<a name="l00189"></a><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0a">00189</a>     <span class="keyword">enum</span> <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0a" title="Enumeration type for Interval exception handling.">TYPE</a>{
<a name="l00190"></a><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0aa106824e7082a75df0192ff04693368b9">00190</a>       <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0aa106824e7082a75df0192ff04693368b9" title="Non positive-semi definite shape matrix.">NONPSD</a>=1,   
<a name="l00191"></a>00191     };
<a name="l00193"></a><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#af26c4d28d91ddc7dbd44a24f3e7ec622">00193</a>     <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#af26c4d28d91ddc7dbd44a24f3e7ec622" title="Constructor for error ierr">Exceptions</a>( <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0a" title="Enumeration type for Interval exception handling.">TYPE</a> <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#ada6c185e8d59013506b87d433f5693e1" title="Return error flag.">ierr</a> ) : _ierr( ierr ){}
<a name="l00195"></a><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#ada6c185e8d59013506b87d433f5693e1">00195</a>     <span class="keywordtype">int</span> <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#ada6c185e8d59013506b87d433f5693e1" title="Return error flag.">ierr</a>(){ <span class="keywordflow">return</span> _ierr; }
<a name="l00197"></a><a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a858d49695fe63f73c00834b9b67c2d86">00197</a>     std::string <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a858d49695fe63f73c00834b9b67c2d86" title="Return error description.">what</a>(){
<a name="l00198"></a>00198       <span class="keywordflow">switch</span>( _ierr ){
<a name="l00199"></a>00199       <span class="keywordflow">case</span> <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0aa106824e7082a75df0192ff04693368b9" title="Non positive-semi definite shape matrix.">NONPSD</a>: <span class="keywordflow">default</span>:
<a name="l00200"></a>00200         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Nonpositive semi-definite shape matrix&quot;</span>;
<a name="l00201"></a>00201       }
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204   <span class="keyword">private</span>:
<a name="l00205"></a>00205     <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0a" title="Enumeration type for Interval exception handling.">TYPE</a> _ierr;
<a name="l00206"></a>00206   };
<a name="l00207"></a>00207 
<a name="l00209"></a>00209   <a class="code" href="group__ELLIPSOID.html#ga7cc9827ae93fbb9bdb28ed472b2864b4" title="Default constructor (needed to declare arrays of Ellipsoid class)">Ellipsoid</a>
<a name="l00210"></a><a class="code" href="group__ELLIPSOID.html#ga7cc9827ae93fbb9bdb28ed472b2864b4">00210</a>     ():
<a name="l00211"></a>00211     _n(0), _p(0), _Q(0), _c(0), _eigQ(NULL,NULL), _sqrtQ(0), _PSDchecked(<span class="keyword">false</span>)
<a name="l00212"></a>00212     {}
<a name="l00214"></a>00214   <a class="code" href="group__ELLIPSOID.html#ga7cc9827ae93fbb9bdb28ed472b2864b4" title="Default constructor (needed to declare arrays of Ellipsoid class)">Ellipsoid</a>
<a name="l00215"></a><a class="code" href="group__ELLIPSOID.html#gadf334513a42293427453dfcd37b1b7d8">00215</a>     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>=0, <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>=0 ):
<a name="l00216"></a>00216     _n(n), _eigQ(NULL,NULL), _sqrtQ(0), _PSDchecked(<span class="keyword">false</span>)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218       <span class="keywordflow">if</span>( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a0d18be5224bb202e532e047c994e82ee" title="Whether or not to check positive semi-definiteness of shape matrices (default=false)">PSDCHK</a> ){
<a name="l00219"></a>00219         <span class="keywordflow">if</span>( !_PSDchecked &amp;&amp; !_isPSD( n, <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>, _eigQ, options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> ) ){
<a name="l00220"></a>00220      std::cout &lt;&lt; <span class="stringliteral">&quot;Min. eigenvalue: &quot;</span> &lt;&lt; *_eigQ.first &lt;&lt; std::endl;
<a name="l00221"></a>00221           <span class="keywordflow">throw</span> <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html" title="Ellipsoid exceptions.">Exceptions</a>( <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0aa106824e7082a75df0192ff04693368b9" title="Non positive-semi definite shape matrix.">Exceptions::NONPSD</a> );
<a name="l00222"></a>00222    }
<a name="l00223"></a>00223         _PSDchecked = <span class="keyword">true</span>;
<a name="l00224"></a>00224       }
<a name="l00225"></a>00225       
<a name="l00226"></a>00226       _p = <span class="keyword">new</span> <span class="keywordtype">double</span>[_n+_n*(_n+1)/2];
<a name="l00227"></a>00227       _c = _p;
<a name="l00228"></a>00228       _Q = _p+_n;
<a name="l00229"></a>00229       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0, k=0; i&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; i++ ){
<a name="l00230"></a>00230         _c[i] = ( <a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>? <a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>[i]: 0.);
<a name="l00231"></a>00231    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=i; j&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; j++, k++ )
<a name="l00232"></a>00232      _Q[k] = ( <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>? <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>[k]: 0. );
<a name="l00233"></a>00233       }
<a name="l00234"></a>00234     }
<a name="l00236"></a>00236   <a class="code" href="group__ELLIPSOID.html#ga7cc9827ae93fbb9bdb28ed472b2864b4" title="Default constructor (needed to declare arrays of Ellipsoid class)">Ellipsoid</a>
<a name="l00237"></a><a class="code" href="group__ELLIPSOID.html#ga07fe81bab0741a2fb94431984d63e823">00237</a>     ( <span class="keyword">const</span> <a class="code" href="classmc_1_1Ellipsoid.html" title="C++ class for ellipsoidal calculus.">Ellipsoid</a>&amp;E ):
<a name="l00238"></a>00238     _n(E._n)
<a name="l00239"></a>00239     {
<a name="l00240"></a>00240       <span class="keywordflow">if</span>( !_n ) <span class="keywordflow">return</span>;
<a name="l00241"></a>00241       _p = <span class="keyword">new</span> <span class="keywordtype">double</span>[_n+_n*(_n+1)/2];
<a name="l00242"></a>00242       _c = _p;
<a name="l00243"></a>00243       _Q = _p+_n;
<a name="l00244"></a>00244       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0, k=0; i&lt;_n; i++ ){
<a name="l00245"></a>00245         _c[i] = E._c[i];
<a name="l00246"></a>00246    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=i; j&lt;_n; j++, k++ ) _Q[k] = E._Q[k];
<a name="l00247"></a>00247       }
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249 
<a name="l00251"></a><a class="code" href="group__ELLIPSOID.html#ga8a3455857f9bb4e4ac9fe496a78adbf4">00251</a>   <a class="code" href="group__ELLIPSOID.html#ga8a3455857f9bb4e4ac9fe496a78adbf4" title="Destructor.">~Ellipsoid</a>()
<a name="l00252"></a>00252     {
<a name="l00253"></a>00253       <span class="keyword">delete</span>[] _p;
<a name="l00254"></a>00254       <span class="keyword">delete</span>[] _eigQ.first;
<a name="l00255"></a>00255       <span class="keyword">delete</span>[] _eigQ.second;
<a name="l00256"></a>00256       <span class="keyword">delete</span>[] _sqrtQ;
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258 
<a name="l00260"></a>00260   <a class="code" href="classmc_1_1Ellipsoid.html" title="C++ class for ellipsoidal calculus.">Ellipsoid</a>&amp; <span class="keyword">set</span>
<a name="l00261"></a><a class="code" href="group__ELLIPSOID.html#gac6d8d4d29482e5d2dd3840ca989424b4">00261</a>     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>=0, <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>=0 )
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263       <span class="keyword">delete</span>[] _eigQ.first;
<a name="l00264"></a>00264       <span class="keyword">delete</span>[] _eigQ.second;
<a name="l00265"></a>00265       <span class="keyword">delete</span>[] _sqrtQ;
<a name="l00266"></a>00266       _eigQ.first = 0;
<a name="l00267"></a>00267       _eigQ.second = 0;
<a name="l00268"></a>00268       _sqrtQ = 0;
<a name="l00269"></a>00269       _PSDchecked = <span class="keyword">false</span>;
<a name="l00270"></a>00270       <span class="comment">//*this = Ellipsoid( n, Q, c );</span>
<a name="l00271"></a>00271       <span class="keywordflow">if</span>( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a0d18be5224bb202e532e047c994e82ee" title="Whether or not to check positive semi-definiteness of shape matrices (default=false)">PSDCHK</a> ){
<a name="l00272"></a>00272         <span class="keywordflow">if</span>( !_PSDchecked &amp;&amp; !_isPSD( n, <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>, _eigQ, options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> ) ){
<a name="l00273"></a>00273      std::cout &lt;&lt; <span class="stringliteral">&quot;Min. eigenvalue: &quot;</span> &lt;&lt; *_eigQ.first &lt;&lt; std::endl;
<a name="l00274"></a>00274           <span class="keywordflow">throw</span> <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html" title="Ellipsoid exceptions.">Exceptions</a>( <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0aa106824e7082a75df0192ff04693368b9" title="Non positive-semi definite shape matrix.">Exceptions::NONPSD</a> );
<a name="l00275"></a>00275    }
<a name="l00276"></a>00276         _PSDchecked = <span class="keyword">true</span>;
<a name="l00277"></a>00277       }
<a name="l00278"></a>00278       
<a name="l00279"></a>00279       <span class="keywordflow">if</span>( _n != n ){
<a name="l00280"></a>00280         _n = <a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>;
<a name="l00281"></a>00281         <span class="keyword">delete</span>[] _p;
<a name="l00282"></a>00282         _p = <span class="keyword">new</span> <span class="keywordtype">double</span>[_n+_n*(_n+1)/2];
<a name="l00283"></a>00283         _c = _p;
<a name="l00284"></a>00284         _Q = _p+_n;
<a name="l00285"></a>00285       }
<a name="l00286"></a>00286       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0, k=0; i&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; i++ ){
<a name="l00287"></a>00287         _c[i] = ( <a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>? <a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>[i]: 0.);
<a name="l00288"></a>00288    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=i; j&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; j++, k++ )
<a name="l00289"></a>00289      _Q[k] = ( <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>? <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>[k]: 0. );
<a name="l00290"></a>00290       }
<a name="l00291"></a>00291       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 
<a name="l00295"></a><a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95">00295</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>()<span class="keyword"> const</span>
<a name="l00296"></a>00296 <span class="keyword">    </span>{
<a name="l00297"></a>00297       <span class="keywordflow">return</span> _n;
<a name="l00298"></a>00298     }
<a name="l00300"></a><a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec">00300</a>   <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="group__ELLIPSOID.html#ga890925aa7dc8bda2d19d2fb6d56cc4ec" title="Return center of ellipsoid.">c</a>()<span class="keyword"> const</span>
<a name="l00301"></a>00301 <span class="keyword">    </span>{
<a name="l00302"></a>00302       <span class="keywordflow">return</span> _c;
<a name="l00303"></a>00303     }
<a name="l00305"></a><a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1">00305</a>   <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>()<span class="keyword"> const</span>
<a name="l00306"></a>00306 <span class="keyword">    </span>{
<a name="l00307"></a>00307       <span class="keywordflow">return</span> _Q;
<a name="l00308"></a>00308     }
<a name="l00310"></a><a class="code" href="group__ELLIPSOID.html#ga4ba3d486af4b1f6be5ed8b1410f7a2c2">00310</a>   <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="group__ELLIPSOID.html#ga4ba3d486af4b1f6be5ed8b1410f7a2c2" title="Return square root of shape matrix.">sqrtQ</a>()
<a name="l00311"></a>00311     {
<a name="l00312"></a>00312       <span class="keywordflow">if</span>( !_sqrtQ ) _sqrtQ = _sqrt( _n, _Q, _eigQ, options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a>, _PSDchecked );
<a name="l00313"></a>00313       <span class="keywordflow">return</span> _sqrtQ;
<a name="l00314"></a>00314     }
<a name="l00316"></a><a class="code" href="group__ELLIPSOID.html#ga1df8ee8e6840e5c11255ff878d8cb21e">00316</a>   std::pair&lt; const double*, const double*&gt; <a class="code" href="group__ELLIPSOID.html#ga1df8ee8e6840e5c11255ff878d8cb21e" title="Return eigenvalues and eigenvectors of shape matrix.">eigQ</a>()
<a name="l00317"></a>00317     {
<a name="l00318"></a>00318       <span class="keywordflow">if</span>( !_eigQ.first || !_eigQ.second ){
<a name="l00319"></a>00319         <span class="keyword">delete</span>[] _eigQ.first;
<a name="l00320"></a>00320         <span class="keyword">delete</span>[] _eigQ.second;
<a name="l00321"></a>00321         _eigQ = _eigen( _n, _Q, options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> );
<a name="l00322"></a>00322       }
<a name="l00323"></a>00323       <span class="keywordflow">return</span> _eigQ;
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325 
<a name="l00327"></a>00327   <span class="keywordtype">double</span> <a class="code" href="group__ELLIPSOID.html#ga6b98c6046f80729be1b8faa1465b5801" title="Return lower bound for  for index .">l</a>
<a name="l00328"></a><a class="code" href="group__ELLIPSOID.html#ga6b98c6046f80729be1b8faa1465b5801">00328</a>     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i )
<a name="l00329"></a>00329     {
<a name="l00330"></a>00330       <span class="keywordflow">return</span>( i&lt;0 || i&gt;=_n ? 0.: -std::sqrt(std::max(0.,_diagQ(i))) );
<a name="l00331"></a>00331     }
<a name="l00333"></a>00333   <span class="keywordtype">double</span> <a class="code" href="group__ELLIPSOID.html#gafc8295e9f41eee43f8ecc648e916686e" title="Return upper bound for  for index .">u</a>
<a name="l00334"></a><a class="code" href="group__ELLIPSOID.html#gafc8295e9f41eee43f8ecc648e916686e">00334</a>     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i )
<a name="l00335"></a>00335     {
<a name="l00336"></a>00336       <span class="keywordflow">return</span>( i&lt;0 || i&gt;=_n ? 0.: std::sqrt(std::max(0.,_diagQ(i))) );
<a name="l00337"></a>00337     }
<a name="l00340"></a>00340 <span class="keyword">private</span>:
<a name="l00341"></a>00341 
<a name="l00343"></a>00343   <span class="keyword">static</span> std::pair&lt;double*,double*&gt; _eigen
<a name="l00344"></a>00344     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*<a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>, <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">Options::SHAPE_MATRIX</a> STORAGE,
<a name="l00345"></a>00345       <span class="keywordtype">bool</span> mat=<span class="keyword">true</span> );
<a name="l00346"></a>00346 
<a name="l00348"></a>00348   <span class="keyword">static</span> <span class="keywordtype">double</span>* _sqrt
<a name="l00349"></a>00349     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*<a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>, std::pair&lt;double*,double*&gt;&amp;<a class="code" href="group__ELLIPSOID.html#ga1df8ee8e6840e5c11255ff878d8cb21e" title="Return eigenvalues and eigenvectors of shape matrix.">eigQ</a>,
<a name="l00350"></a>00350       <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">Options::SHAPE_MATRIX</a> STORAGE, <span class="keywordtype">bool</span>&amp;PSDchecked );
<a name="l00351"></a>00351 
<a name="l00353"></a>00353   <span class="keyword">static</span> <span class="keywordtype">bool</span> _isPSD
<a name="l00354"></a>00354     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*<a class="code" href="group__ELLIPSOID.html#gaef0e5727413571a3ff74db585633e9b1" title="Return shape matrix of ellipsoid.">Q</a>, std::pair&lt;double*,double*&gt;&amp;<a class="code" href="group__ELLIPSOID.html#ga1df8ee8e6840e5c11255ff878d8cb21e" title="Return eigenvalues and eigenvectors of shape matrix.">eigQ</a>,
<a name="l00355"></a>00355       <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">Options::SHAPE_MATRIX</a> STORAGE );
<a name="l00356"></a>00356   
<a name="l00358"></a>00358   <span class="keyword">static</span> <span class="keywordtype">void</span> _display
<a name="l00359"></a>00359     ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*a,
<a name="l00360"></a>00360       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lda, <span class="keyword">const</span> std::string&amp;stra,
<a name="l00361"></a>00361       std::ostream&amp;os=std::cout );
<a name="l00362"></a>00362   
<a name="l00364"></a>00364   <span class="keyword">static</span> <span class="keywordtype">void</span> _pause()
<a name="l00365"></a>00365     { <span class="keywordtype">double</span> tmp;
<a name="l00366"></a>00366       std::cout &lt;&lt; <span class="stringliteral">&quot;ENTER &lt;1&gt; TO CONTINUE&quot;</span> &lt;&lt; std::endl;
<a name="l00367"></a>00367       std::cin  &gt;&gt; tmp; }
<a name="l00368"></a>00368 };
<a name="l00369"></a>00369 
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 Ellipsoid::Options Ellipsoid::options;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374 <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00375"></a>00375 Ellipsoid::_isPSD
<a name="l00376"></a>00376 ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*Q, std::pair&lt;double*,double*&gt;&amp;eigQ,
<a name="l00377"></a>00377   Options::SHAPE_MATRIX STORAGE )
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379   <span class="keywordflow">if</span>( !eigQ.first || !eigQ.second ){
<a name="l00380"></a>00380     <span class="keyword">delete</span>[] eigQ.first;
<a name="l00381"></a>00381     <span class="keyword">delete</span>[] eigQ.second;
<a name="l00382"></a>00382     eigQ = _eigen( n, Q, STORAGE );
<a name="l00383"></a>00383   }
<a name="l00384"></a>00384   <span class="keywordflow">if</span>( !eigQ.first ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00385"></a>00385   <span class="keywordtype">bool</span> isPSD = <span class="keyword">true</span>;
<a name="l00386"></a>00386   <span class="keywordflow">if</span>( *eigQ.first &lt; -std::fabs( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a368ec5b16a4899f959abb2578c0d0a8b" title="Tolerance for positive semi-definiteness check of shape matrices (default=1e2*mc::machprec())">PSDTOL</a> ) ){
<a name="l00387"></a>00387     std::cout &lt;&lt; <span class="stringliteral">&quot;Min. eigenvalue: &quot;</span> &lt;&lt; *eigQ.first &lt;&lt; std::endl;
<a name="l00388"></a>00388     <span class="keywordtype">int</span> dum; std::cin &gt;&gt; dum;
<a name="l00389"></a>00389     isPSD = <span class="keyword">false</span>;
<a name="l00390"></a>00390   }
<a name="l00391"></a>00391   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; i++ ){
<a name="l00392"></a>00392     <span class="keywordflow">if</span>( eigQ.first[i] &lt; 0. ) eigQ.first[i] = 0.;
<a name="l00393"></a>00393     <span class="keywordflow">else</span> <span class="keywordflow">break</span>;
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395   <span class="keywordflow">return</span> isPSD;
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="keyword">inline</span> <span class="keywordtype">double</span>*
<a name="l00399"></a>00399 Ellipsoid::_sqrt
<a name="l00400"></a>00400 ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*Q, std::pair&lt;double*,double*&gt;&amp;eigQ,
<a name="l00401"></a>00401   <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">Ellipsoid::Options::SHAPE_MATRIX</a> STORAGE, <span class="keywordtype">bool</span>&amp;PSDchecked )
<a name="l00402"></a>00402 {
<a name="l00403"></a>00403   <span class="keywordtype">bool</span> isPSD = _isPSD( n, Q, eigQ, STORAGE );
<a name="l00404"></a>00404   <span class="keywordflow">if</span>( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a0d18be5224bb202e532e047c994e82ee" title="Whether or not to check positive semi-definiteness of shape matrices (default=false)">PSDCHK</a> ){
<a name="l00405"></a>00405     <span class="keywordflow">if</span>( !PSDchecked &amp;&amp; !isPSD )
<a name="l00406"></a>00406       <span class="keywordflow">throw</span> Exceptions( <a class="code" href="classmc_1_1Ellipsoid_1_1Exceptions.html#a083adbc018956e9014b118b2c5626f0aa106824e7082a75df0192ff04693368b9" title="Non positive-semi definite shape matrix.">Exceptions::NONPSD</a> );
<a name="l00407"></a>00407     PSDchecked = <span class="keyword">true</span>;
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409   <span class="keywordflow">if</span>( !eigQ.first ) <span class="keywordflow">return</span> 0;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411   <span class="keywordtype">double</span> *<a class="code" href="group__ELLIPSOID.html#ga4ba3d486af4b1f6be5ed8b1410f7a2c2" title="Return square root of shape matrix.">sqrtQ</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[n*<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>];
<a name="l00412"></a>00412   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; i++ )
<a name="l00413"></a>00413     <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; j++ ){
<a name="l00414"></a>00414       sqrtQ[i+j*<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>] = 0.;
<a name="l00415"></a>00415       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; k++ )
<a name="l00416"></a>00416         sqrtQ[i+j*n] += ( eigQ.second[i+k*n] * std::sqrt( eigQ.first[k] ) )
<a name="l00417"></a>00417                    * eigQ.second[j+k*<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>];
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <span class="preprocessor">#ifdef MC__ELLIPSOID_DEBUG_SQRT</span>
<a name="l00421"></a>00421 <span class="preprocessor"></span>  <span class="keywordtype">double</span>* Qchk = <span class="keyword">new</span> <span class="keywordtype">double</span>[n*<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>];
<a name="l00422"></a>00422   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; i++ )
<a name="l00423"></a>00423     <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; j++ ){
<a name="l00424"></a>00424       Qchk[i+j*<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>] = 0.;
<a name="l00425"></a>00425       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; k++ )
<a name="l00426"></a>00426         Qchk[i+j*n] += sqrtQ[i+k*n] * sqrtQ[k+j*n];
<a name="l00427"></a>00427     }
<a name="l00428"></a>00428   _display( n, n, Qchk, n, <span class="stringliteral">&quot;Matrix sqrtQ*sqrtQ&quot;</span>, std::cout );
<a name="l00429"></a>00429   <span class="keyword">delete</span>[] Qchk;
<a name="l00430"></a>00430 <span class="preprocessor">#endif</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="group__ELLIPSOID.html#ga4ba3d486af4b1f6be5ed8b1410f7a2c2" title="Return square root of shape matrix.">sqrtQ</a>;
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 <span class="keyword">inline</span> std::pair&lt;double*,double*&gt;
<a name="l00435"></a>00435 Ellipsoid::_eigen
<a name="l00436"></a>00436 ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*Q, <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5" title="Enumeration type for shape matrix storage.">Ellipsoid::Options::SHAPE_MATRIX</a> STORAGE,
<a name="l00437"></a>00437   <span class="keywordtype">bool</span> mat )
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439   <span class="keywordtype">int</span> info;
<a name="l00440"></a>00440   <span class="keywordtype">double</span>*d = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>];
<a name="l00441"></a>00441   <span class="keywordtype">double</span>*U = <span class="keyword">new</span> <span class="keywordtype">double</span>[n*<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>];
<a name="l00442"></a>00442   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0, k=0; j&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; j++ )
<a name="l00443"></a>00443     <span class="keywordflow">switch</span>( STORAGE ){
<a name="l00444"></a>00444     <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">Options::LOWER</a>:
<a name="l00445"></a>00445       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=j; i&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; i++ )  U[j*n+i] = U[i*n+j] = Q[k++]; <span class="keywordflow">break</span>;
<a name="l00446"></a>00446     <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3" title="Upper triangular part of shape matrix stored row-wise.">Options::UPPER</a>:
<a name="l00447"></a>00447       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=j; i++ ) U[j*n+i] = U[i*n+j] = Q[k++]; <span class="keywordflow">break</span>;
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449 <span class="preprocessor">#ifdef MC__ELLIPSOID_DEBUG_EIGEN</span>
<a name="l00450"></a>00450 <span class="preprocessor"></span>  _display( n, n, U, n, <span class="stringliteral">&quot;Matrix Q&quot;</span>, std::cout );
<a name="l00451"></a>00451 <span class="preprocessor">#endif</span>
<a name="l00452"></a>00452 <span class="preprocessor"></span>
<a name="l00453"></a>00453   <span class="comment">// get optimal size</span>
<a name="l00454"></a>00454   <span class="keywordtype">double</span> worktmp;
<a name="l00455"></a>00455   <span class="keywordtype">int</span> lwork = -1;
<a name="l00456"></a>00456   <span class="keywordflow">switch</span>( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> ){
<a name="l00457"></a>00457   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">Options::LOWER</a>:
<a name="l00458"></a>00458     dsyev_( <span class="stringliteral">&quot;Vectors&quot;</span>, <span class="stringliteral">&quot;Lower&quot;</span>, &amp;n, U, &amp;n, d, &amp;worktmp, &amp;lwork, &amp;info ); <span class="keywordflow">break</span>;
<a name="l00459"></a>00459   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3" title="Upper triangular part of shape matrix stored row-wise.">Options::UPPER</a>:
<a name="l00460"></a>00460     dsyev_( <span class="stringliteral">&quot;Vectors&quot;</span>, <span class="stringliteral">&quot;Upper&quot;</span>, &amp;n, U, &amp;n, d, &amp;worktmp, &amp;lwork, &amp;info ); <span class="keywordflow">break</span>;
<a name="l00461"></a>00461   }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   <span class="comment">// perform eigenvalue decomposition</span>
<a name="l00464"></a>00464   lwork = (int)worktmp;
<a name="l00465"></a>00465   <span class="keywordtype">double</span>*work = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];
<a name="l00466"></a>00466   <span class="keywordflow">switch</span>( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> ){
<a name="l00467"></a>00467   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">Options::LOWER</a>:
<a name="l00468"></a>00468     dsyev_( <span class="stringliteral">&quot;Vectors&quot;</span>, <span class="stringliteral">&quot;Lower&quot;</span>, &amp;n, U, &amp;n, d, work, &amp;lwork, &amp;info ); <span class="keywordflow">break</span>;
<a name="l00469"></a>00469   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3" title="Upper triangular part of shape matrix stored row-wise.">Options::UPPER</a>:
<a name="l00470"></a>00470     dsyev_( <span class="stringliteral">&quot;Vectors&quot;</span>, <span class="stringliteral">&quot;Upper&quot;</span>, &amp;n, U, &amp;n, d, work, &amp;lwork, &amp;info ); <span class="keywordflow">break</span>;
<a name="l00471"></a>00471   }
<a name="l00472"></a>00472 <span class="preprocessor">#ifdef MC__ELLIPSOID_DEBUG_EIGEN</span>
<a name="l00473"></a>00473 <span class="preprocessor"></span>  _display( n, n, U, n, <span class="stringliteral">&quot;Matrix U&quot;</span>, std::cout );
<a name="l00474"></a>00474   _display( 1, n, d, 1, <span class="stringliteral">&quot;Matrix D&quot;</span>, std::cout );
<a name="l00475"></a>00475 <span class="preprocessor">#endif</span>
<a name="l00476"></a>00476 <span class="preprocessor"></span>  <span class="keyword">delete</span>[] work;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 <span class="preprocessor">#ifdef MC__ELLIPSOID_DEBUG_EIGEN</span>
<a name="l00479"></a>00479 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">&quot;INFO: &quot;</span> &lt;&lt; info &lt;&lt; std::endl;
<a name="l00480"></a>00480   _pause();
<a name="l00481"></a>00481 <span class="preprocessor">#endif</span>
<a name="l00482"></a>00482 <span class="preprocessor"></span>  <span class="keywordtype">double</span>* pnull = 0;
<a name="l00483"></a>00483   <span class="keywordflow">if</span>( info ){ <span class="keyword">delete</span>[] d; <span class="keyword">delete</span>[] U; <span class="keywordflow">return</span> std::make_pair(pnull,pnull); }
<a name="l00484"></a>00484   <span class="keywordflow">if</span>( !mat ){ <span class="keyword">delete</span>[] U; U = 0; }
<a name="l00485"></a>00485   <span class="keywordflow">return</span> std::make_pair( d, U );
<a name="l00486"></a>00486 }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00489"></a>00489 Ellipsoid::_display
<a name="l00490"></a>00490 ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span>*a,
<a name="l00491"></a>00491   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lda, <span class="keyword">const</span> std::string&amp;stra, std::ostream&amp;os )
<a name="l00492"></a>00492 {
<a name="l00493"></a>00493   os &lt;&lt; stra &lt;&lt; <span class="stringliteral">&quot; =&quot;</span> &lt;&lt; std::endl &lt;&lt; std::scientific
<a name="l00494"></a>00494      &lt;&lt; std::setprecision(5);
<a name="l00495"></a>00495   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> im=0; a &amp;&amp; im&lt;m; im++ ){
<a name="l00496"></a>00496     <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> in=0; in&lt;<a class="code" href="group__ELLIPSOID.html#gab5d9f2b4bc4cc17d4c9c03f3333f5d95" title="Return dimension of ellipsoid.">n</a>; in++ ){
<a name="l00497"></a>00497       os &lt;&lt; a[in*lda+im] &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;
<a name="l00498"></a>00498     }
<a name="l00499"></a>00499     os &lt;&lt; std::endl;
<a name="l00500"></a>00500   }
<a name="l00501"></a>00501   os &lt;&lt; std::endl;
<a name="l00502"></a>00502 
<a name="l00503"></a>00503   <span class="keywordflow">if</span>( os == std::cout || os == std::cerr ) _pause();
<a name="l00504"></a>00504 }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 <span class="keyword">inline</span> <span class="keywordtype">double</span>
<a name="l00507"></a>00507 Ellipsoid::_diagQ
<a name="l00508"></a>00508 ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i )<span class="keyword"> const</span>
<a name="l00509"></a>00509 <span class="keyword"></span>{
<a name="l00510"></a>00510   <span class="keywordflow">switch</span>( options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> ){
<a name="l00511"></a>00511   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">Options::LOWER</a>:
<a name="l00512"></a>00512     <span class="keywordflow">return</span> _Q[_n*i-i*(i-1)/2];
<a name="l00513"></a>00513   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3" title="Upper triangular part of shape matrix stored row-wise.">Options::UPPER</a>: <span class="keywordflow">default</span>:
<a name="l00514"></a>00514     <span class="keywordflow">return</span> _Q[i*(i+1)/2+i];
<a name="l00515"></a>00515   }
<a name="l00516"></a>00516 }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518 <span class="keyword">inline</span> std::ostream&amp;
<a name="l00519"></a>00519 <span class="keyword">operator</span>&lt;&lt;
<a name="l00520"></a>00520 ( std::ostream&amp;out, <span class="keyword">const</span> Ellipsoid&amp;E)
<a name="l00521"></a>00521 {
<a name="l00522"></a>00522   <span class="keyword">const</span> <span class="keywordtype">int</span> iprec = 5;
<a name="l00523"></a>00523   out &lt;&lt; std::scientific &lt;&lt; std::setprecision(iprec);
<a name="l00524"></a>00524   out &lt;&lt; <span class="stringliteral">&quot;\n n: &quot;</span>  &lt;&lt; std::left &lt;&lt; std::setw(3) &lt;&lt; E._n &lt;&lt; std::right;
<a name="l00525"></a>00525   <span class="keywordflow">if</span>( !E._n ) <span class="keywordflow">return</span> out;
<a name="l00526"></a>00526   <span class="keywordflow">switch</span>( E.options.<a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#aa973f4a88ce7426b67d19fcef36a0109" title="Storage format for shape matrix (default=LOWER)">STORAGE</a> ){
<a name="l00527"></a>00527   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a5258478de449053365c88aecd5c926ba" title="Lower triangular part of shape matrix stored row-wise.">Ellipsoid::Options::LOWER</a>:
<a name="l00528"></a>00528     <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;E._n; i++ ){
<a name="l00529"></a>00529       <span class="keywordflow">if</span>( !i ){ out &lt;&lt; <span class="stringliteral">&quot;   c:&quot;</span> &lt;&lt; std::setw(iprec+8) &lt;&lt; E._c[0]
<a name="l00530"></a>00530                     &lt;&lt; <span class="stringliteral">&quot;   Q:&quot;</span> &lt;&lt; std::setw(iprec+8) &lt;&lt; E._Q[0]; <span class="keywordflow">continue</span>; }
<a name="l00531"></a>00531       out &lt;&lt; std::endl
<a name="l00532"></a>00532           &lt;&lt; std::setw(12+iprec+8) &lt;&lt; E._c[i]
<a name="l00533"></a>00533      &lt;&lt; std::setw(5+iprec+8)  &lt;&lt; E._Q[i];
<a name="l00534"></a>00534       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=1; j&lt;=i; j++ )
<a name="l00535"></a>00535         out &lt;&lt; std::setw(iprec+8) &lt;&lt; E._Q[E._n*j-j*(j-1)/2+i-j];
<a name="l00536"></a>00536     }
<a name="l00537"></a>00537     out &lt;&lt; std::endl;
<a name="l00538"></a>00538     <span class="keywordflow">break</span>;
<a name="l00539"></a>00539   <span class="keywordflow">case</span> <a class="code" href="structmc_1_1Ellipsoid_1_1Options.html#a6f07b73d6b9db7891e4aa7aee51382c5a21c5701beb5d7702a3a791ab86b421a3" title="Upper triangular part of shape matrix stored row-wise.">Ellipsoid::Options::UPPER</a>: <span class="keywordflow">default</span>:
<a name="l00540"></a>00540     <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;E._n; i++ ){
<a name="l00541"></a>00541       <span class="keywordflow">if</span>( !i ) out &lt;&lt; <span class="stringliteral">&quot;   c:&quot;</span> &lt;&lt; std::setw(iprec+8) &lt;&lt; E._c[0]
<a name="l00542"></a>00542                    &lt;&lt; <span class="stringliteral">&quot;   Q:&quot;</span>;
<a name="l00543"></a>00543       <span class="keywordflow">else</span> out &lt;&lt; std::setw(12+iprec+8) &lt;&lt; E._c[i]
<a name="l00544"></a>00544                &lt;&lt; std::setw(5+(iprec+8)*i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;      
<a name="l00545"></a>00545       <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=i; j&lt;E._n; j++ )
<a name="l00546"></a>00546         out &lt;&lt; std::setw(iprec+8) &lt;&lt; E._Q[j*(j+1)/2+i];
<a name="l00547"></a>00547       out &lt;&lt; std::endl;
<a name="l00548"></a>00548     }
<a name="l00549"></a>00549     <span class="keywordflow">break</span>;
<a name="l00550"></a>00550   }
<a name="l00551"></a>00551   <span class="keywordflow">return</span> out;
<a name="l00552"></a>00552 }
<a name="l00553"></a>00553 
<a name="l00554"></a>00554 } <span class="comment">// namespace mc</span>
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>ellipsoid.hpp</b>      </li>

    <li class="footer">Generated on Thu Jul 11 2013 16:03:13 for ODEBND_GSL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
