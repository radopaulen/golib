<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ODEBND_GSL: ODEBND_GSL (version 1.0): Enclosing the Reachable Set of Parametric Nonlinear ODEs using Continuous-Time Set-Propagation Methods</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ODEBND_GSL
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('index.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">ODEBND_GSL (version 1.0): Enclosing the Reachable Set of Parametric Nonlinear ODEs using Continuous-Time Set-Propagation Methods </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="author"><dt><b>Author:</b></dt><dd>Benoit C. Chachuat (<a href="mailto:b.chachuat@imperial.ac.uk">b.chachuat@imperial.ac.uk</a>), Radoslav Paulen (<a href="mailto:Radoslav.Paulen@bci.tu-dortmund.de">Radoslav.Paulen@bci.tu-dortmund.de</a>), Mario Villanueva (<a href="mailto:mario.villanueva10@imperial.ac.uk">mario.villanueva10@imperial.ac.uk</a>), and Boris Houska (<a href="mailto:bhouska@sjtu.edu.cn">bhouska@sjtu.edu.cn</a>) </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.0 </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2012-2013</dd></dl>
<p><a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> is a C++ class that computes enclosures of the reachable set of parametric nonlinear ordinary differential equations (ODEs) of the form </p>
<p class="formulaDsp">
\[\forall t\in[t_0,t_{\rm f}] \quad \dot{x}(t)=f(x(t),p) \quad\text{with}\quad x(t_0)=h(p), \]
</p>
<p> where \(p\in P\subset\mathbb{R}^{n_p}\) denote the parameter vector; \(x(t)\in\mathbb{R}^{n_x}\), the state vector at a given time \(t\); \(f: \mathbb{R}^{n_x}\times\mathbb{R}^{n_p}\to\mathbb{R}^{n_x}\), the right-hand side function; and \(h: \mathbb{R}^{n_p}\to\mathbb{R}^{n_x}\), the initial value function. It is assumed that \(f\) and \(h\) are factorable and sufficiently many times continuously differentiable.</p>
<p>The algorithms in <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> rely on continuous-time set-propagation methods, whereby a set of auxiliary ODEs is constructed whose solutions provide the desired enclosures. Two different approaches are implemented, which enable the propagation of convex enclosures and nonconvex enclosures, based on interval arithmetic and Taylor model arithmetic, respectively. In either approaches, various contractors can be used, including:</p>
<ul>
<li>differential inequalities contractor [Lakshmikantham &amp; Leela, 1969; Walter, 1970; Harrison, 1977]</li>
<li>parallelepiped contractor</li>
<li>ellipsoidal contractor [Houska <em>et al.</em>, 2012]</li>
</ul>
<p>Combination of these contractors with Taylor models are described, for instance, in [Chachuat &amp; Villanueva, 2012; Villanueva <em>et al.</em>, 2013a]. Moreover, the construction and convergence analysis of these methods is described in [Villanueva <em>et al.</em>, 2013b], whereby a generalized differential inequality is introduced whose solutions yield such support functions for a convex enclosure of the reachable set. In particular, it is shown that existing continuous-time propagation techniques based on standard differential inequalities or ellipsoidal set propagation techniques can be recovered as special cases of this generalized differential inequality, and a way of extending this approach for the construction of nonconvex enclosures is also described based on Taylor models with convex remainder bounds.</p>
<h2><a class="anchor" id="sec_ODEBND_GSL_use"></a>
How Do I Obtain, Install and Run mc::ODEBND_GSL?</h2>
<p><a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> is released as open source code under the <a href="http://www.eclipse.org/legal/epl-v10.html">Eclipse Public License (EPL)</a>.</p>
<p><a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> uses a number of third-party libraries. The following are <b>mandatory</b> to run <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a>:</p>
<ul>
<li>Library <a href="http://www3.imperial.ac.uk/environmentenergyoptimisation/software">MC++</a> (version 1.0), computing interval bounds, convex/concave bounds and Taylor models for factorable functions</li>
<li>Library <a href="http://www.fadbad.com/fadbad.html">FADBAD++</a> (version 2.1), implementing the forward, backward and Taylor methods of automatic differentiation (AD)</li>
<li>Integrator <code>gsl_odeiv2</code> in the <a href="https://www.gnu.org/software/gsl/manual/html_node/Ordinary-Differential-Equations.html">GNU Scientific Library (GSL, version 1.15)</a> in order to solve the auxiliary ODEs</li>
<li>Libraries <a href="http://www.netlib.org/blas/">BLAS</a> and <a href="http://www.netlib.org/lapack/">LAPACK</a> for linear algebra computations</li>
</ul>
<p><b>Optional</b> libraries include:</p>
<ul>
<li>Libraries <a href="http://www.ti3.tu-harburg.de/Software/PROFILEnglisch.html">PROFIL</a> and/or <a href="http://www.math.uni-wuppertal.de/~xsc/software/filib.html">FILIB++</a>, implementing verified interval arithmetic</li>
</ul>
<p>On distribution, the main directory should contain the files <code>AUTHORS</code>,<code>CHANGELOG</code>, <code>INSTALL</code>, <code>LICENSE</code> and <code>README</code>, as well as 3 subdirectories: <code>src</code>, <code>test</code>, and <code>doc</code>. The library comes with a Doxygen documentation, which can be accessed by opening the file <code>doc/html/index.html</code> with any html interpreter. Also, a test example is provided in the <code>test</code> subdirectory. Note that <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> consists of header files only, which can be found in the <code>src</code> directory.</p>
<p>Running <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> first requires that you alter the <code>makefile</code> in order to point to the third-party libraries. A test example is provided in the subdirectory <code>test</code>. Change to this directory and type the following from the command line:</p>
<div class="fragment"><pre class="fragment">
  $ make
</pre></div><p>This creates the executable file <code>test</code>, which can be executed by doing:</p>
<div class="fragment"><pre class="fragment">
  $ ./test
</pre></div><p>The following output should be produced:</p>
<div class="fragment"><pre class="fragment">

COMPUTE APPROXIMATE ENCLOSURE OF REACHABLE SET:

 @t = 0.0000e+00 :
 x[0] = [  1.20000e+00 :  1.20000e+00 ]
 x[1] = [  1.10000e+00 :  1.10000e+00 ]
 @t = 2.0000e+00 :
 x[0] = [  1.21919e+00 :  1.22654e+00 ]
 x[1] = [  1.00707e+00 :  1.05317e+00 ]

COMPUTE INTERVAL ENCLOSURE OF REACHABLE SET:

 @t = 0.0000e+00 :
 x[0] = [  1.20000e+00 :  1.20000e+00 ]
 x[1] = [  1.10000e+00 :  1.10000e+00 ]
 @t = 2.0000e+00 :
 x[0] = [  1.21989e+00 :  1.22724e+00 ]
 x[1] = [  1.00701e+00 :  1.05316e+00 ]
 No EVALATIONS   RHS: 411   JAC: 0
 CPU TIME (SEC)     0.00477

 @t = 0.0000e+00 :
 d[0] = 0.0000e+00
 d[1] = 0.0000e+00
 @t = 2.0000e+00 :
 d[0] = 7.0361e-04
 d[1] = 5.8547e-05

COMPUTE TAYLOR MODEL ENCLOSURE OF REACHABLE SET:

 @t = 0.0000e+00 :
 x[0] = 
    a0   =  1.20000e+00

  Order:        Bound:
       R        [  0.00000e+00 :  0.00000e+00 ]

  TM Bound:          [  1.20000e+00 :  1.20000e+00 ]

 x[1] = 
    a0   =  1.10000e+00

  Order:        Bound:
       R        [  0.00000e+00 :  0.00000e+00 ]

  TM Bound:          [  1.10000e+00 :  1.10000e+00 ]

 @t = 2.0000e+00 :
 x[0] = 
    a0   =  1.22427e+00        0    B0   = [  1.00000e+00 :  1.00000e+00 ]
    a1   = -7.35819e-02        1    B1   = [ -5.00000e-02 :  5.00000e-02 ]
    a2   = -5.63430e-01        2    B2   = [  0.00000e+00 :  2.50000e-03 ]
    a3   =  1.12415e-02        3    B3   = [ -1.25000e-04 :  1.25000e-04 ]
    a4   =  3.79181e-01        4    B4   = [  0.00000e+00 :  6.25000e-06 ]

  Order:        Bound:
       0        [  1.22427e+00 :  1.22427e+00 ]
       1        [ -3.67909e-03 :  3.67909e-03 ]
       2        [ -1.40858e-03 :  0.00000e+00 ]
       3        [ -1.40518e-06 :  1.40518e-06 ]
       4        [  0.00000e+00 :  2.36988e-06 ]
       R        [ -1.53111e-07 :  1.53111e-07 ]

  TM Bounder:1
  TM Bound:          [  1.21918e+00 :  1.22655e+00 ]

 x[1] = 
    a0   =  1.03005e+00        0    B0   = [  1.00000e+00 :  1.00000e+00 ]
    a1   =  4.62023e-01        1    B1   = [ -5.00000e-02 :  5.00000e-02 ]
    a2   =  2.78256e-02        2    B2   = [  0.00000e+00 :  2.50000e-03 ]
    a3   = -4.05412e-01        3    B3   = [ -1.25000e-04 :  1.25000e-04 ]
    a4   = -1.70854e-01        4    B4   = [  0.00000e+00 :  6.25000e-06 ]

  Order:        Bound:
       0        [  1.03005e+00 :  1.03005e+00 ]
       1        [ -2.31011e-02 :  2.31011e-02 ]
       2        [  0.00000e+00 :  6.95640e-05 ]
       3        [ -5.06765e-05 :  5.06765e-05 ]
       4        [ -1.06784e-06 :  0.00000e+00 ]
       R        [ -1.52531e-07 :  1.52531e-07 ]

  TM Bounder:1
  TM Bound:          [  1.00697e+00 :  1.05327e+00 ]

 No EVALATIONS   RHS: 471   JAC: 0
 CPU TIME (SEC)     0.00764

 @t = 0.0000e+00 :
 d[0] = 0.0000e+00   r[0] = 0.0000e+00
 d[1] = 0.0000e+00   r[1] = 0.0000e+00
 @t = 2.0000e+00 :
 d[0] = 5.4006e-06   r[0] = 1.7543e-07
 d[1] = 1.0253e-04   r[1] = 1.0585e-07

</pre></div><p>We note that <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> has only been tested under Linux/Ubuntu using the GCC compiler.</p>
<h2><a class="anchor" id="sec_ODEBND_GSL_setup"></a>
How Do I Set up my ODE Problem in mc::ODEBND_GSL?</h2>
<p>The class <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> is templated in two variable types T and IVP:</p>
<ul>
<li>T is the class that implements the underlying interval arithmetic. Both verified and non-verified types are currently supported. For verified interval computations [optional], the libraries <a href="http://www.ti3.tu-harburg.de/Software/PROFILEnglisch.html">PROFIL</a> and <a href="http://www.math.uni-wuppertal.de/~xsc/software/filib.html">FILIB++</a> are supported; the non-verified interval type mc::Interval in <a href="http://www3.imperial.ac.uk/environmentenergyoptimisation/software">MC++</a> can also be used. More generally, any interval type can be used provided that the templated structure mc::Op is instantiated for that type -- see the header files <code>mcprofil.h</code> and <code>mcfilib.h</code> for examples of such instantiations.</li>
<li>IVP is the class that defines the initial value problem in ODEs to be bounded. An example is detailed next.</li>
</ul>
<p>Suppose we want to bound the reachable set of the following Lotka-Volterra system: </p>
<p class="formulaDsp">
\[\left\{\begin{array}{rl} \dot{x}_1(t)=px_1(t)\,[1-x_2(t)] &amp; \quad \text{with}\quad x_1(0)=1.2\\ \dot{x}_2(t)=px_2(t)\,[x_1(t)-1] &amp; \quad \text{with}\quad x_2(0)=1.1, \end{array}\right.\]
</p>
<p> that depends on the (scalar) parameter \(p\). The following class, derived from <a class="el" href="classmc_1_1ODESTRUCT.html" title="C++ class defining the structure of parametric ODE problems.">mc::ODESTRUCT</a>, is defined:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">      #include &quot;odebnd_gsl.hpp&quot;</span>
      
      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NP = 1;  <span class="comment">// Parameter dimension</span>
      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NX = 2;  <span class="comment">// State dimension</span>

      <span class="keyword">class </span>IVP : <span class="keyword">public</span> mc::ODESTRUCT
      {
      <span class="keyword">public</span>:
        IVP(): mc::ODESTRUCT( NP, NX )
          {}

        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt;
        U RHS                     <span class="comment">// Right-hand side function</span>
          ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix, <span class="keyword">const</span> U*p, <span class="keyword">const</span> U*x, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is )
          {
            <span class="keywordflow">switch</span>( ix ){
              <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> p[0]*x[0]*(1.-x[1]);
              <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> p[0]*x[1]*(x[0]-1.);
              <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid size&quot;</span>);
            }
          }

        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt;
        U IC                      <span class="comment">// Initial value function</span>
          ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix, <span class="keyword">const</span> U*p )
          {
            <span class="keywordflow">switch</span>( ix ){
              <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> 1.2;
              <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> 1.1;
              <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid size&quot;</span>);
            }
          }
      };
</pre></div><h2><a class="anchor" id="sec_ODEBND_GSL_IA"></a>
How Do I Compute an Interval Enclosure of the Reachable Set of my ODE Problem?</h2>
<p>Suppose we want to compute an interval enclosure of the reachable set of the Lotka-Volterra system defined previously, with \(p\in [2.95,3.05]\) and final time \(t_{\rm f}=2\).</p>
<p>We start by defining the parameter set \(P\), initial time \(t_0\), and final time \(t_{\rm f}\):</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">      #include &quot;interval.hpp&quot;</span>
      <span class="keyword">typedef</span> mc::Interval I;
      I Ip[NP];
      Ip[0] = I(2.95,3.05);
      <span class="keywordtype">double</span> t0 = 0., tf = 2.;
</pre></div><p>An <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> object is then defined as:</p>
<div class="fragment"><pre class="fragment">      <a class="code" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL&lt;I,IVP&gt;</a> LV;
</pre></div><p>For simplicity, we have defined the template type T of <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> as the default interval type mc::Interval in <a href="http://www3.imperial.ac.uk/environmentenergyoptimisation/software">MC++</a> here.</p>
<p>At this stage, <b>options</b> can be specified via the mc::ODEBND_GSL::options public member; see <a class="el" href="index.html#sec_ODEBND_GSL_opt">How Are the Options Set in mc::ODEBND_GSL?</a> for a complete list of options. For instance, display can be enabled and intermediate results can be recorded by setting the DISPLAY and RESRECORD options as:</p>
<div class="fragment"><pre class="fragment">      LV.options.<a class="code" href="structmc_1_1ODEBND__GSL_1_1Options.html#a44d2e73a71c8188267decf082d733cd3" title="Display level.">DISPLAY</a> = 1;
      LV.options.<a class="code" href="structmc_1_1ODEBND__GSL_1_1Options.html#a89a423efec0fa423b4b39d1ef37ba809" title="Whether or not to record results (default: false)">RESRECORD</a> = <span class="keyword">true</span>;
</pre></div><p>An <b>interval enclosure of the reachable set</b> at \(t_{\rm f}\) can now be computed by invoking the method <a class="el" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">mc::ODEBND_GSL::bounds</a> as follows:</p>
<div class="fragment"><pre class="fragment">      I Ix0[NX], Ixf[NX];
      I* Ixk[2] = {Ix0, Ixf};
      <span class="keywordtype">double</span> tk[2] = {t0, tf};
      LV.<a class="code" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">bounds</a>( 1, tk, Ip, Ixk );
</pre></div><p>Note that <b>enclosures at intermediate times</b> can also be computed by modifying the arrays tk and Xk accordingly.</p>
<p>The following result is displayed during the computations:</p>
<div class="fragment"><pre class="fragment">
 @t = 0.0000e+00 :
 x[0] = [  1.20000e+00 :  1.20000e+00 ]
 x[1] = [  1.10000e+00 :  1.10000e+00 ]
 @t = 2.0000e+00 :
 x[0] = [  1.21989e+00 :  1.22724e+00 ]
 x[1] = [  1.00701e+00 :  1.05316e+00 ]
 No EVALATIONS   RHS: 411   JAC: 0
 CPU TIME (SEC)     0.01377
</pre></div><p>With the default options, this enclosure was generated using an ellipsoidal contractor with wrapping mitigation order of 2 and the integration method is an explicit embedded Runge-Kutta-Fehlberg (4,5) method with both relative and absolute tolerances set to 1e-6.</p>
<p>Results can be <b>exported to a file</b> by using the method <a class="el" href="group__ODEBND__GSL.html#ga2220e344f4b1f95bd6612dea86dd197f" title="Record results in file bndrec, with accuracy of iprec digits.">mc::ODEBND_GSL::record</a> after an integration was completed:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">      #include &lt;fstream&gt;</span>
      std::ofstream ofile( <span class="stringliteral">&quot;LV.out&quot;</span>, std::ios_base::out );
      LV.<a class="code" href="group__ODEBND__GSL.html#ga2220e344f4b1f95bd6612dea86dd197f" title="Record results in file bndrec, with accuracy of iprec digits.">record</a>( ofile );
</pre></div><p>This creates (or updates) the file <code>LV.out</code> in the current directory as follows -- This requires the option RESRECORD to be set to `true' before calling <a class="el" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">mc::ODEBND_GSL::bounds</a>:</p>
<div class="fragment"><pre class="fragment">
   0.00000e+00   1.20000e+00   1.20000e+00   1.10000e+00   1.10000e+00
   2.00000e+00   1.21989e+00   1.22724e+00   1.00701e+00   1.05316e+00
</pre></div><p>An <b>approximation of the actual reachable set</b> can also be computed by invoking the method <a class="el" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">mc::ODEBND_GSL::bounds</a> with the following alternative interface:</p>
<div class="fragment"><pre class="fragment">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NSAMP = 100;  <span class="comment">// Number of sample points</span>
      LV.<a class="code" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">bounds</a>( 1, tk, Ip, Ixk, NSAMP );
</pre></div><p>This method simply evaluates the ODEs by sampling parameter set at NSAMP equally spaced points, and keeping whichever response is minimal or maximal. The following result is displayed in this case -- which appears quite close to the computed enclosure:</p>
<div class="fragment"><pre class="fragment">
 @t = 0.0000e+00 :
 x[0] = [  1.20000e+00 :  1.20000e+00 ]
 x[1] = [  1.10000e+00 :  1.10000e+00 ]
 @t = 2.0000e+00 :
 x[0] = [  1.21919e+00 :  1.22654e+00 ]
 x[1] = [  1.00707e+00 :  1.05317e+00 ]
</pre></div><p>Note that this brute force approach quickly becomes computationally intractable when the ODE problem contains more than just a few parameters, especially for a large number of sample points for each parameter.</p>
<p>Similarly, an <b>estimate of the Hausdorff distance</b> between the computed enclosure and the actual reachable set -- after projection onto each variable -- can be computed by using the method <a class="el" href="group__ODEBND__GSL.html#gad730af913b42c07da5b3f9fbc398e305" title="Computes Hausdorff distance between interval enclosure and actual reachable set of parametric ODEs...">mc::ODEBND_GSL::hausdorff</a> as follows: </p>
<div class="fragment"><pre class="fragment">      <span class="keywordtype">double</span> Hx0[NX], Hxf[NX];
      <span class="keywordtype">double</span>* Hxk[2] = {Hx0, Hxf};
      LV.<a class="code" href="group__ODEBND__GSL.html#gad730af913b42c07da5b3f9fbc398e305" title="Computes Hausdorff distance between interval enclosure and actual reachable set of parametric ODEs...">hausdorff</a>( 1, tk, Ip, Hxk, NSAMP );
</pre></div><p>The following result is displayed after the computations:</p>
<div class="fragment"><pre class="fragment">
 @t = 0.0000e+00 :
 d[0] = 0.0000e+00
 d[1] = 0.0000e+00
 @t = 2.0000e+00 :
 d[0] = 7.0361e-04
 d[1] = 5.8547e-05
</pre></div><p>In particular, such estimates of the Hausdorff metric are useful to assess the convergence rate of the bounding techniques.</p>
<h2><a class="anchor" id="sec_ODEBND_GSL_TM"></a>
How Do I Compute a Taylor Model Enclosure of the Reachable Set of my ODE Problem?</h2>
<p>We now consider computing a 4th-order Taylor model enclosure of the reachable set of the same Lotka-Volterra system.</p>
<p>A Taylor model of the parameter set \(P\) is first defined as, </p>
<div class="fragment"><pre class="fragment">      <span class="keyword">typedef</span> mc::TModel&lt;I&gt; TM;
      <span class="keyword">typedef</span> mc::TVar&lt;I&gt; TV;

      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NTM = 4; <span class="comment">// Order of Taylor model</span>
      TM TMenv( NP, NTM );        <span class="comment">// Taylor model environment</span>
      TV TMp[NP];
      TMp[0] = TV( &amp;TMenv, 0, I(2.95,3.05) );
</pre></div><p>The desired Taylor model enclosure is computed exactly as previously -- the method <a class="el" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">mc::ODEBND_GSL::bounds</a> being overloaded for Taylor model type:</p>
<div class="fragment"><pre class="fragment">      TV TMx0[NX], TMxf[NX];
      TV* TMxk[2] = {TMx0, TMxf};
      LV.<a class="code" href="group__ODEBND__GSL.html#gaadf9676df3bf0a5e24024f5888a7c6f9" title="Computes approximate interval enclosure of reachable set of parametric ODEs using parameter sampling...">bounds</a>( 1, tk, TMp, TMxk );
</pre></div><p>The following result is displayed:</p>
<div class="fragment"><pre class="fragment">
 @t = 0.0000e+00 :
 x[0] = 
    a0   =  1.20000e+00

  Order:        Bound:
       R        [  0.00000e+00 :  0.00000e+00 ]

  TM Bound:          [  1.20000e+00 :  1.20000e+00 ]

 x[1] = 
    a0   =  1.10000e+00

  Order:        Bound:
       R        [  0.00000e+00 :  0.00000e+00 ]

  TM Bound:          [  1.10000e+00 :  1.10000e+00 ]

 @t = 2.0000e+00 :
 x[0] = 
    a0   =  1.22427e+00        0    B0   = [  1.00000e+00 :  1.00000e+00 ]
    a1   = -7.35819e-02        1    B1   = [ -5.00000e-02 :  5.00000e-02 ]
    a2   = -5.63430e-01        2    B2   = [  0.00000e+00 :  2.50000e-03 ]
    a3   =  1.12415e-02        3    B3   = [ -1.25000e-04 :  1.25000e-04 ]
    a4   =  3.79181e-01        4    B4   = [  0.00000e+00 :  6.25000e-06 ]

  Order:        Bound:
       0        [  1.22427e+00 :  1.22427e+00 ]
       1        [ -3.67909e-03 :  3.67909e-03 ]
       2        [ -1.40858e-03 :  0.00000e+00 ]
       3        [ -1.40519e-06 :  1.40519e-06 ]
       4        [  0.00000e+00 :  2.36988e-06 ]
       R        [ -1.53112e-07 :  1.53112e-07 ]

  TM Bounder:1
  TM Bound:          [  1.21918e+00 :  1.22655e+00 ]

 x[1] = 
    a0   =  1.03005e+00        0    B0   = [  1.00000e+00 :  1.00000e+00 ]
    a1   =  4.62023e-01        1    B1   = [ -5.00000e-02 :  5.00000e-02 ]
    a2   =  2.78255e-02        2    B2   = [  0.00000e+00 :  2.50000e-03 ]
    a3   = -4.05412e-01        3    B3   = [ -1.25000e-04 :  1.25000e-04 ]
    a4   = -1.70854e-01        4    B4   = [  0.00000e+00 :  6.25000e-06 ]

  Order:        Bound:
       0        [  1.03005e+00 :  1.03005e+00 ]
       1        [ -2.31011e-02 :  2.31011e-02 ]
       2        [  0.00000e+00 :  6.95638e-05 ]
       3        [ -5.06765e-05 :  5.06765e-05 ]
       4        [ -1.06784e-06 :  0.00000e+00 ]
       R        [ -1.52469e-07 :  1.52469e-07 ]

  TM Bounder:1
  TM Bound:          [  1.00697e+00 :  1.05327e+00 ]

 No EVALATIONS   RHS: 277   JAC: 0
 CPU TIME (SEC)     0.01972
</pre></div><p>An <b>estimate of the Hausdorff distances</b> between the bounds derived from the Taylor model enclosure and the actual reachable set and between the Taylor model remainder bound and the actual range of the remainder function -- after projection onto each variable -- can be computed by using the method <a class="el" href="group__ODEBND__GSL.html#gad730af913b42c07da5b3f9fbc398e305" title="Computes Hausdorff distance between interval enclosure and actual reachable set of parametric ODEs...">mc::ODEBND_GSL::hausdorff</a> as follows: </p>
<div class="fragment"><pre class="fragment">      <span class="keywordtype">double</span> Hx0[NX], Hxf[NX] Rx0[NX], Rxf[NX];
      <span class="keywordtype">double</span>* Hxk[2] = {Hx0, Hxf};
      <span class="keywordtype">double</span>* Rxk[2] = {Rx0, Rxf};
      LV.<a class="code" href="group__ODEBND__GSL.html#gad730af913b42c07da5b3f9fbc398e305" title="Computes Hausdorff distance between interval enclosure and actual reachable set of parametric ODEs...">hausdorff</a>( 1, tk, TMp, Hxk, Rxk, NSAMP );
</pre></div><p>The following result is displayed after the computations:</p>
<div class="fragment"><pre class="fragment">
 @t = 0.0000e+00 :
 d[0] = 0.0000e+00   r[0] = 0.0000e+00
 d[1] = 0.0000e+00   r[1] = 0.0000e+00
 @t = 2.0000e+00 :
 d[0] = 5.3533e-06   r[0] = 1.3315e-07
 d[1] = 1.0252e-04   r[1] = 1.1046e-07
</pre></div><p>Note, in particular, that the Hausdorff distances between the bounds derived from the Taylor model enclosure and the actual range of the remainder function is less than the actual Taylor model remainder bound.</p>
<h2><a class="anchor" id="sec_ODEBND_GSL_opt"></a>
How Are the Options Set in mc::ODEBND_GSL?</h2>
<p>The options are defined in the structure <a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html" title="Integrator options.">mc::ODEBND_GSL::Options</a>. Current options are as follows:</p>
<table  border="1">
<caption align="bottom"><em>Options in <a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html" title="Integrator options.">mc::ODEBND_GSL::Options</a>: name, type and description</em></caption>
<tr>
<th><b>Name</b> </th><td><b>Type</b></td><td><b>Default</b> </td><td><b>Description</b> </td></tr>
<tr>
<th><code>INTMETH</code> </th><td><code><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a7288ccdb8ffbf828bc6a3856ca18680b" title="Enumeration of numerical integration algorithms.">mc::ODEBND_GSL::Options::INTEGRATION_METHOD</a></code> </td><td><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a7288ccdb8ffbf828bc6a3856ca18680ba0e20e1696da89664e7e7f670bc09d22c" title="Explicit embedded Runge-Kutta-Fehlberg (4,5) method (non-stiff systems) [Default].">mc::ODEBND_GSL::Options::RKF45</a> </td><td>Numerical integration method </td></tr>
<tr>
<th><code>WRAPMIT</code> </th><td><code><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9" title="Enumeration of wrapping mitigation strategies.">mc::ODEBND_GSL::Options::WRAPPING_STRATEGY</a></code> </td><td><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9a75e39523cfd3e21516d575114490fbc9" title="Ellipsoidal contractor with linear preconditioning [Default].">mc::ODEBND_GSL::Options::ELLIPS</a> </td><td>Wrapping mitigation strategy </td></tr>
<tr>
<th><code>ORDMIT</code> </th><td><code>unsigned int</code> </td><td>2 </td><td>Order of nonlinearity bounder in ellipsoidal contractor </td></tr>
<tr>
<th><code>H0</code> </th><td><code>double</code> </td><td>1e-2 </td><td>Initial step-size </td></tr>
<tr>
<th><code>HMIN</code> </th><td><code>double</code> </td><td>0e0 (unrestricted) </td><td>Minimum step-size </td></tr>
<tr>
<th><code>NMAX</code> </th><td><code>unsigned int</code> </td><td>0 (unlimited) </td><td>Maximum number of steps in a time stage </td></tr>
<tr>
<th><code>ATOL</code> </th><td><code>double</code> </td><td>1e-6 </td><td>Absolute tolerance for <code>gsl_odeiv2</code> </td></tr>
<tr>
<th><code>RTOL</code> </th><td><code>double</code> </td><td>1e-6 </td><td>Relative tolerance for <code>gsl_odeiv2</code> </td></tr>
<tr>
<th><code>QTOL</code> </th><td><code>double</code> </td><td>mc::machprec() </td><td>Tolerance when dividing by trace of shape matrix in ellipsoidal bounds </td></tr>
<tr>
<th><code>DISPLAY</code> </th><td><code>int</code> </td><td>0 (no display) </td><td>Display option </td></tr>
<tr>
<th><code>RESRECORDY</code> </th><td><code>bool</code> </td><td>false </td><td>Keep track of intermediate results </td></tr>
</table>
<p>The <a class="el" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL</a> class has a public (non-static) member called mc::ODEBND_GSL::options that can be used to set/modify the options; e.g.,</p>
<div class="fragment"><pre class="fragment">      <a class="code" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL&lt;T,IVP&gt;</a> LV;
      LV.options.<a class="code" href="structmc_1_1ODEBND__GSL_1_1Options.html#a14cc291d2e3ab23de2406028ab11f183" title="Relative integration tolerance (Default: 1e-6)">RTOL</a> = LV.options.<a class="code" href="structmc_1_1ODEBND__GSL_1_1Options.html#ab21ee6ddabba1567de491e644c03dac9" title="Absolute integration tolerance (Default: 1e-6)">ATOL</a> = 1e-6;
      LV.options.<a class="code" href="structmc_1_1ODEBND__GSL_1_1Options.html#a2970fd3648287217979f4ad9072af22d" title="Numerical integration method.">INTMETH</a> = <a class="code" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL&lt;T,IVP&gt;::Options::RK8PD</a>;
      LV.options.<a class="code" href="structmc_1_1ODEBND__GSL_1_1Options.html#a85b266aac3db31b441ac0f3a5e9351b9" title="Wrapping mitigation strategy.">WRAPMIT</a> = <a class="code" href="classmc_1_1ODEBND__GSL.html" title="C++ class computing enclosures of the reachable set of parametric ODEs using GSL and MC++...">mc::ODEBND_GSL&lt;T,IVP&gt;::Options::DINEQ</a>;
</pre></div><p>Remarks:</p>
<p>Not all integration methods in the enumeration <a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a7288ccdb8ffbf828bc6a3856ca18680b" title="Enumeration of numerical integration algorithms.">mc::ODEBND_GSL::Options::INTEGRATION_METHOD</a> can be used with all methods. For instance, the multistep methods <a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a7288ccdb8ffbf828bc6a3856ca18680ba904e2c49e287e83a7badabb3540bada4" title="Variable-coefficient linear multistep Adams method in Nordsieck form (non-stiff systems)">mc::ODEBND_GSL::Options::MSADAMS</a> and <a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a7288ccdb8ffbf828bc6a3856ca18680ba7e1f8f1adb75471d234227950f654f8d" title="Variable-coefficient linear multistep backward differentiation formula (BDF) method in Nordsieck form...">mc::ODEBND_GSL::Options::MSBDF</a> only work for classical integration, not reachable set enclosures.</p>
<p>The following wrapping mitigation strategies are currently implemented in the enumeration <a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9" title="Enumeration of wrapping mitigation strategies.">mc::ODEBND_GSL::Options::WRAPPING_STRATEGY</a>:</p>
<ul>
<li><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9a7e1e961ef8665de61cc10e4278d2db85" title="No wrapping mitigation.">mc::ODEBND_GSL::Options::NONE</a> No wrapping mitigation</li>
<li><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9ab791ef4572245d51eed022773facf70b" title="Differential inequality contractor.">mc::ODEBND_GSL::Options::DINEQ</a> Differential inequality contractor</li>
<li><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9aaaea4f2a5a3ae9dea9685087decaa311" title="Linear preconditioning.">mc::ODEBND_GSL::Options::LINTRANS</a> Linear preconditioning</li>
<li><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9a5e9391b73f2b6f89d86a12b0760aefe0" title="Differential inequality with linear preconditioning.">mc::ODEBND_GSL::Options::DITRANS</a> Differential inequality with linear preconditioning</li>
<li><a class="el" href="structmc_1_1ODEBND__GSL_1_1Options.html#a1e06f07f3ca94ed01c9357f8c218e4c9a75e39523cfd3e21516d575114490fbc9" title="Ellipsoidal contractor with linear preconditioning [Default].">mc::ODEBND_GSL::Options::ELLIPS</a> Ellipsoidal contractor with linear preconditioning</li>
</ul>
<p>All five strategies are applicable for interval and Taylor model bounding.</p>
<h2><a class="anchor" id="sec_ODEBND_GSL_err"></a>
What Errors Can I Encounter with mc::ODEBND_GSL?</h2>
<p>Errors are managed based on the exception handling mechanism of the C++ language. Each time an error is encountered, a class object ODEBND_GSL::Exceptions is thrown, which contains the type of error. It is the user's responsibility to test whether an exception was thrown during the integration of parametric ODEs, and then make the appropriate changes. Should an exception be thrown and not caught by the calling program, the execution will stop.</p>
<p>Possible errors encountered during the computation of bounds on the solutions of parametric ODEs are:</p>
<table  border="1">
<caption align="bottom"><em>Errors during propagation of enclosures for parametric ODEs</em></caption>
<tr>
<th><b>Number</b> </th><td><b>Description</b> </td></tr>
<tr>
<th><code>-33</code> </th><td>Error due to calling a feature not yet implemented </td></tr>
</table>
<p>Moreover, exceptions may be thrown by the embedded class T itself or by third-party programs.</p>
<h2><a class="anchor" id="sec_ODEBND_GSL_refs"></a>
References</h2>
<p>Chachuat, B. and M.E. Villanueva, <a href="http://www.sciencedirect.com/science/article/pii/B9780444595201501202">"Bounding the solutions of parametric ODEs: When Taylor models meet differential inequalities"</a>, <em>Proceedings of the 22nd European Conference on Computer Aided Process Engineering (ESCAPE 22)</em>, I.D. Bogle and M. Fairweather (Eds), 2012</p>
<p>Harrison, G. W., "Dynamic Models with Uncertain Parameters", <em>Proceedings of the 1st International Conference on Mathematical Modeling</em>, X. Avula (Ed), vol. 1, pp. 295-304, 1977</p>
<p>Houska, B., F. Logist, J. Van Impe, and M. Diehl, <a href="http://www.sciencedirect.com/science/article/pii/S095915241200073X">"Robust optimization of nonlinear dynamic systems with application to a jacketed tubular reactor"</a>, <em>Journal of Process Control</em>, <b>22</b>(6):1152-1160, 2012</p>
<p>Lakshmikantham, V., S. Leela, <em><a href="http://books.google.co.uk/books/about/Differential_and_integral_inequalities_t.html?id=_sZ_SlLHtiQC&amp;redir_esc=y">"Differential and Integral Inequalities, Theory and Applications: Volume I, Ordinary Differential Equations"</a></em>, Academic Press, 1969</p>
<p>Villanueva, M.E., B. Houska, and B. Chachuat, <a href="http://link.springer.com/journal/10898">"Unified framework for the propagation of continuous-time enclosures for parametric nonlinear ODEs"</a>, <em>Journal of Global Optimization</em>, <b>submitted</b>, 2013</p>
<p>Villanueva, M.E., R. Paulen, B. Houska, and B. Chachuat, <a href="http://www.sciencedirect.com">"Enclosing the reachable set of parametric ODEs using Taylor models and ellipsoidal calculus"</a>, <em>Proceedings of the 23rd European Conference on Computer Aided Process Engineering (ESCAPE 23)</em>, A. Kraslawski and I. Turunen (Eds), 2013</p>
<p>Walter, W., <em><a href="http://books.google.co.uk/books/about/Differential_and_integral_inequalities.html?id=DU8fAQAAIAAJ&amp;redir_esc=y">"Differential and Integral Inequalities"</a></em>, Springer-Verlag, Berlin, 1970 </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Thu Jul 11 2013 16:03:13 for ODEBND_GSL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
