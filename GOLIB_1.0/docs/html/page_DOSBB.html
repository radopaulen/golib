<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GOLIB: Deterministic Global Optimization of Parametric IVPs in ODEs using Spatial Branch-and-Bound</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GOLIB
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('page_DOSBB.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Deterministic Global Optimization of Parametric IVPs in ODEs using Spatial Branch-and-Bound </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="author"><dt><b>Author:</b></dt><dd>Benoit C. Chachuat </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>0.1 </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2011 </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000003">Bug:</a></b></dt><dd>No known bugs.</dd></dl>
<p>Consider a dynamic optimization (DO) problem of the form </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \min_{{\bf p}\in P}\ &amp; \phi_0({\bf p}, {\bf x}(t_0),\ldots,{\bf x}(t_N)) + \int_{t_0}^{t_N} \psi_0({\bf p}, {\bf x}(t))\, dt\\ \text{s.t.} \ &amp; \phi_k({\bf p}, {\bf x}(t_0),\ldots,{\bf x}(t_N)) + \int_{t_0}^{t_N} \psi_k({\bf p}, {\bf x}(t))\, dt \{\geq,=,\leq\} 0, \quad k=1,\ldots,n_c\\ &amp; \dot{{\bf x}}(t)={\bf f}({\bf p},{\bf x}(t)),\ t\in(t_0,t_{N}]; \quad {\bf x}(t_0)={\bf h}({\bf p}) \end{align*}" src="form_33.png"/>
</p>
<p> where <img class="formulaInl" alt="${\bf p}\in P\subset\mathbb{R}^{n_p}$" src="form_34.png"/>, <img class="formulaInl" alt="${\bf x}\in\mathbb{R}^{n_x}$" src="form_35.png"/>, and the real-valued functions <img class="formulaInl" alt="${\bf f}$" src="form_36.png"/>, <img class="formulaInl" alt="${\bf h}$" src="form_37.png"/>, <img class="formulaInl" alt="$\phi_k$" src="form_38.png"/> and <img class="formulaInl" alt="$\psi_k$" src="form_39.png"/> are twice continuously differentiable in all their arguments and factorable. The class <a class="el" href="classmc_1_1DOSBB.html" title="C++ class for global solution of dynamic optimization using spatial branch-and-bound.">mc::DOSBB</a> in MC++ uses branch-and-bound search to solve such DO problems to global optimality. A relaxation of the DO problem is constructed using the class mc::ODEBND that computes bounds on the solutions of parametric IVPs, and local solution are computed based on the class <a class="el" href="classmc_1_1DOSEQ.html" title="C++ class for local solution of dynamic optimization using IPOPT, CVODES and FADBAD++.">mc::DOSEQ</a> which implements a sequential approach using numerical integration and local NLP search.</p>
<p><a class="el" href="classmc_1_1DOSBB.html" title="C++ class for global solution of dynamic optimization using spatial branch-and-bound.">mc::DOSBB</a> is templated in two variable types T and DO:</p>
<ul>
<li>T is the class that performs the underlying interval arithmetics. Both verified and non-verified types are supported. For verified computations, the libraries <a href="http://www.ti3.tu-harburg.de/Software/PROFILEnglisch.html">PROFIL</a> and <a href="http://www.math.uni-wuppertal.de/~xsc/software/filib.html">FILIB++</a> are supported; the non-verified interval type mc::Interval of MC++ can also be used. More generally, any interval type can be used provided that the templated structure mc::Op is instantiated accordingly -- see the header files <code>mcprofil.h</code> and <code>mcfilib.h</code> for examples.</li>
<li>DO is the class that defines the DO problem to be solved, which has to be a class derived from <a class="el" href="classmc_1_1DOSTRUCT.html" title="C++ base class for dynamic optimization problem formulation.">mc::DOSTRUCT</a>. For example, suppose we want to solve the following dynamic optimization problem: <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \max_{T,x_1^0,u_1,\ldots,u_N}\ &amp; T \\ \text{s.t.} \ &amp; x_1(1) = 1\\ &amp; x_2(1) = 0\\ &amp; \left.\begin{array}{l} \dot{x_1}(t) = x_2(t)\\ \dot{x_2}(t) = (u_k-x_1(t)-2*x_2(t))\theta(t)\\ \dot{\theta}(t) = T \end{array}\right\},\ t\in({\textstyle\frac{k-1}{N},\frac{k}{N}}],\ k=1,\ldots,N\\ &amp; x_1(0) = x_1^0,\ x_2(0) = 0,\ \theta(0) = 0 \end{align*}" src="form_40.png"/>
</p>
 with <img class="formulaInl" alt="$N=5$" src="form_41.png"/> stages. The following class is defined: <div class="fragment"><pre class="fragment"><span class="preprocessor">      #include &quot;dosbb.h&quot;</span>

      <span class="comment">// Number of time stages</span>
      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NS = 5;
      <span class="comment">// Number of decision variables</span>
      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NP = 2+NS;
      <span class="comment">// Number of state variables</span>
      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NX = 3;
      <span class="comment">// Number of constraints</span>
      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NC = 2;

      <span class="keyword">class </span>DO : <span class="keyword">public</span> <span class="keyword">virtual</span> mc::DOSTRUCT
      {
      <span class="keyword">public</span>:
        DO()
          : mc::DOSTRUCT( NP, NX, NC )
          {}

        <span class="comment">// ODEs right-hand side</span>
   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TX, <span class="keyword">typename</span> TP&gt;
        TX RHS
          ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix, <span class="keyword">const</span> TP*p, <span class="keyword">const</span> TX*x, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is )
          {
            assert( ix &lt; nx() );
            <span class="keywordflow">switch</span>( ix ){
              <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> p[0]*x[1];
              <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> p[0]*(p[2+is]-x[0]-2*x[1])*x[2];
              <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> p[0];
              <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid size&quot;</span>);
            }
          }
      
        <span class="comment">// Initial conditions</span>
        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
        T IC
          ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix, <span class="keyword">const</span> T*p )
          {
            assert( ix &lt; nx() );
            <span class="keywordflow">switch</span>( ix ){
              <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> p[1];
              <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> 0.;
              <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> 0.;
              <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid size&quot;</span>);
            }
          }

        <span class="comment">// Objective functional</span>
        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
        std::pair&lt;T,t_OBJ&gt; OBJ
          ( <span class="keyword">const</span> T*p, T* <span class="keyword">const</span>*x, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ns )
          {
            <span class="keywordflow">return</span> std::make_pair( p[0], MIN );
          }

        <span class="comment">// Constraint functionals</span>
        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
        std::pair&lt;T,t_CTR&gt; CTR
          ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ic, <span class="keyword">const</span> T*p, T* <span class="keyword">const</span>*x, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ns )
          {
            <span class="keywordflow">switch</span>( ic ){
              <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> std::make_pair( x[ns][0]-1., EQ );
              <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> std::make_pair( x[ns][1]-0., EQ );
              <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid size&quot;</span>);
            }
          }
      };
</pre></div></li>
</ul>
<h2><a class="anchor" id="sec_DOSBB_solve"></a>
How to Solve a DO Model using mc::DOSBB?</h2>
<p>Start by defining the parameter set <img class="formulaInl" alt="$P$" src="form_42.png"/> and initial guess <img class="formulaInl" alt="$p_0$" src="form_43.png"/>:</p>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">double</span> p0[NP], tk[NS+1];
  std::pair&lt;double,double&gt; P[NP];
  p0[0] = 1.;   P[0] = std::make_pair( 0.1, 2. );
  p0[1] = 0.5;  P[1] = std::make_pair( -1., 1. );
  tk[0] = 0.;
  <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is=0; is&lt;NS; is++ ){
    P[2+is]  = std::make_pair( -0.5, 1.5 );
    p0[2+is] = 0.;
    tk[1+is] = tk[is]+1./(double)NS;
  }
</pre></div><p>Then, define an <a class="el" href="classmc_1_1DOSBB.html" title="C++ class for global solution of dynamic optimization using spatial branch-and-bound.">mc::DOSBB</a> object:</p>
<div class="fragment"><pre class="fragment">  <a class="code" href="classmc_1_1DOSBB.html" title="C++ class for global solution of dynamic optimization using spatial branch-and-bound.">mc::DOSBB&lt;T,DO&gt;</a> pDO = <span class="keyword">new</span> <a class="code" href="classmc_1_1DOSBB.html" title="C++ class for global solution of dynamic optimization using spatial branch-and-bound.">mc::DOSBB&lt;T,DO&gt;</a>;
</pre></div><p>The DO model is optimized as follows:</p>
<div class="fragment"><pre class="fragment">  std::pair&lt;double,const double*&gt; optimum = pDO-&gt;<a class="code" href="group__DOSBB.html#ga3739f0d002ae4b34c655880f3590f6fd" title="Solve DO model -- return value is status.">solve</a>( NS, tk, P, p0 );
</pre></div><p>where the first and second arguments are the number and value of the time stages, the third one is the variable bounds, and the last one is the initial guess used by the optimizer (IPOPT). The return value is of a pair, whereby the first element is the best solution found (incumbent) and the point at which it is attained. If the problem is infeasible, the first argument turns out to be equal to <a class="el" href="structmc_1_1SBB_1_1Options.html#acf789e405b95604a45e3d2c555ea67e1" title="Infinite.">mc::SBB::Options::INF</a> and the second one is a 0 pointer.</p>
<p>The following result is obtained for this problem:</p>
<div class="fragment"><pre class="fragment">
 INDEX STACK   CUMUL TIME      RELAX           INC     PARENT      LBD           UBD       ACTION  
     1     1  0.000000e+00 -1.000000e+20  1.000000e+20     0  1.000000e-01  1.563176e+00   BRANCH0
     2     2  8.480530e-01  1.000000e-01  1.563176e+00     1  1.266758e+00  1.563176e+00   BRANCH2
     3     3  5.204326e+00  1.000000e-01  1.563176e+00     1  1.563176e+00       SKIPPED    FATHOM
     4     2  7.656479e+00  1.266758e+00  1.563176e+00     2    INFEASIBLE       SKIPPED    FATHOM
     5     1  9.016564e+00  1.266758e+00  1.563176e+00     2  1.563175e+00       SKIPPED    FATHOM

#  NORMAL TERMINATION: 11.512720 CPU SEC  (LBD:99.1%  UBD:0.9%)
#  INCUMBENT VALUE:  1.563176e+00
#  INCUMBENT POINT:  1.563176e+00  1.000000e+00  1.500000e+00  1.500000e+00
#                    1.500000e+00  2.808999e-02 -5.000000e-01
#  INCUMBENT FOUND AT NODE: 1
#  TOTAL NUMBER OF NODES:   5
#  MAXIMUM NODES IN STACK:  3
</pre></div><p>Finally, computational statistics for the SBB algorithm can be obtained from the stat public member of <a class="el" href="classmc_1_1DOSBB.html" title="C++ class for global solution of dynamic optimization using spatial branch-and-bound.">mc::DOSBB</a>, a structure with the following fields:</p>
<ul>
<li>stats.cumul_SBB total time taken by the spatial B&amp;B algorithm</li>
<li>stats.cumul_DOLOC cumulated time spent for solving the local DO subproblems</li>
<li>stats.cumul_ODEBND cumulated time spent for bounding the ODE solutions</li>
<li>stats.cumul_FPREL cumulated time spent for generating the LP relaxations of the DO subproblems</li>
<li>stats.cumul_REDUC cumulated time spent for tightening variable bounds (domain reduction)</li>
<li>stats.cumul_DOLOC cumulated time spent for solving the relaxed DO subproblems <div class="fragment"><pre class="fragment">    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(1)
      &lt;&lt; <span class="stringliteral">&quot;\n  Total Time: &quot;</span> &lt;&lt; GDO.stats.cumul_SBB
      &lt;&lt; <span class="stringliteral">&quot;\n  DOLOC: &quot;</span>  &lt;&lt; GDO.stats.cumul_DOLOC/GDO.stats.cumul_SBB*1e2  &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>
      &lt;&lt; <span class="stringliteral">&quot;    ODEBND: &quot;</span> &lt;&lt; GDO.stats.cumul_ODEBND/GDO.stats.cumul_SBB*1e2 &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>
      &lt;&lt; <span class="stringliteral">&quot;    LPREL: &quot;</span>  &lt;&lt; GDO.stats.cumul_FPREL/GDO.stats.cumul_SBB*1e2  &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>
      &lt;&lt; <span class="stringliteral">&quot;    REDUC: &quot;</span>  &lt;&lt; GDO.stats.cumul_REDUC/GDO.stats.cumul_SBB*1e2  &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>
      &lt;&lt; <span class="stringliteral">&quot;    DOREL: &quot;</span>  &lt;&lt; GDO.stats.cumul_DOREL/GDO.stats.cumul_SBB*1e2  &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>
      &lt;&lt; std::endl;
</pre></div></li>
</ul>
<p>The following output is obtained for the illustrative example, indicating that about 85% of the computational time is used for tightening the varaible bounds and for bounding the parametric ODE solutions:</p>
<div class="fragment"><pre class="fragment">
  DOLOC: 0.9%    ODEBND: 31.5%    FPREL: 13.0%    REDUC: 53.3%    DOREL: 1.3%
</pre></div> </div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Thu Feb 13 2014 20:08:12 for GOLIB by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
