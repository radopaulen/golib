<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GOLIB: Deterministic Global Optimization of Nonlinear Programs using Spatial Branch-and-Bound</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GOLIB
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('page_NLPSBB.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Deterministic Global Optimization of Nonlinear Programs using Spatial Branch-and-Bound </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="author"><dt><b>Author:</b></dt><dd>Benoit C. Chachuat </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>0.1 </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2011 </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000007">Bug:</a></b></dt><dd>No known bugs.</dd></dl>
<p>Consider a nonlinear program (NLP) of the form </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \min_{{\bf x}\in X}\ &amp; f({\bf x})\\ \text{s.t.} \ &amp; g_j({\bf x})\{\leq,=,\geq\} 0,\ j=1,\ldots,n_g\\ &amp; x_i^\ell\leq x_i\leq x_i^u,\ i=1,\ldots,n_x \end{align*}" src="form_55.png"/>
</p>
<p> where <img class="formulaInl" alt="$X\subset\mathbb{R}^{n_x}$" src="form_56.png"/>, and <img class="formulaInl" alt="$f, g_1, \ldots,g_{n_g}$" src="form_53.png"/> are potentially nonconvex functions that are factorable and twice continuously differentiable on <img class="formulaInl" alt="$X$" src="form_57.png"/>. The class <a class="el" href="classmc_1_1NLPSBB.html" title="C++ class for global solution of nonconvex NLPs using spatial branch-and-bound.">mc::NLPSBB</a> in MC++ uses branch-and-bound search to solve such NLPs to global optimality. An LP relaxation of the NLP is constructed using the class <a class="el" href="classmc_1_1FPRelax.html" title="C++ template base class for the definition and linear relaxation of factorable programs.">mc::FPRelax</a> and solved using either <a href="http://www-01.ibm.com/software/integration/optimization/cplex-optimizer/">CPLEX</a> or <a href="http://www.gurobi.com/">GUROBI</a>, while local solution are obtained based on the class <a class="el" href="classmc_1_1IPOPT.html" title="C++ derived class for NLP solution using IPOPT and FADBAD++.">mc::IPOPT</a> which calls the software package <a href="https://projects.coin-or.org/Ipopt">IPOPT</a>.</p>
<p><a class="el" href="classmc_1_1NLPSBB.html" title="C++ class for global solution of nonconvex NLPs using spatial branch-and-bound.">mc::NLPSBB</a> is templated in two variable types T and NLP:</p>
<ul>
<li>T is the class that performs the underlying interval arithmetics. Both verified and non-verified types are supported. For verified computations, the libraries <a href="http://www.ti3.tu-harburg.de/Software/PROFILEnglisch.html">PROFIL</a> and <a href="http://www.math.uni-wuppertal.de/~xsc/software/filib.html">FILIB++</a> are supported; the non-verified interval type mc::Interval of MC++ can also be used. More generally, any interval type can be used provided that the templated structure mc::Op is instantiated accordingly -- see the header files <code>mcprofil.h</code> and <code>mcfilib.h</code> for examples.</li>
<li>NLP is the class that defines the optimization problem to be solved, which has to be a class derived from <a class="el" href="classmc_1_1NLPSTRUCT.html" title="C++ base class for nonlinear optimization problem formulation.">mc::NLPSTRUCT</a>. For example, suppose we want to solve the following NLP: <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \max_{\bf x}\ &amp; x_1+x_2 \\ \text{s.t.} \ &amp; x_1\,x_2 \leq 4 \\ &amp; 3 \leq x_1 \leq 6\\ &amp; 0 \leq x_2 \leq 4. \end{align*}" src="form_58.png"/>
</p>
 The following class is defined: <div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &quot;nlpsbb.h&quot;</span>
  
  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NX = 2;
  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NG = 1;

  <span class="keyword">class </span>NLP : <span class="keyword">public</span> <span class="keyword">virtual</span> mc::NLPSTRUCT
  {
  <span class="keyword">public</span>:
    NLP(): mc::NLPSTRUCT( NX, NG )
      {}

    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt;
    std::pair&lt;U,t_OBJ&gt; OBJ
      ( <span class="keyword">const</span> U*x )
      {
        <span class="keywordflow">return</span> std::make_pair( x[0]+x[1], MAX );
      }

    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt;
    std::pair&lt;U,t_CTR&gt; CTR
      ( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ig, <span class="keyword">const</span> U*x )
      {
        assert( ig &lt; ng() );
        <span class="keywordflow">switch</span>( ig ){
          <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> std::make_pair( x[0]*x[1]-4, LE );
          <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid size&quot;</span>);
        }
      }
  };
</pre></div> where NX and NG stand for the number of parameters and constraints, respectively; and the templated functions OBJ and CTR define the objective function and left-hand side of the constraints, respectively.</li>
</ul>
<h2><a class="anchor" id="sec_NLPBB_solve"></a>
How to Solve an NLP Model using mc::NLPSBB?</h2>
<p>Start by defining the parameter set <img class="formulaInl" alt="$X$" src="form_57.png"/> and initial guess <img class="formulaInl" alt="$x_0$" src="form_59.png"/>:</p>
<div class="fragment"><pre class="fragment">  std::pair&lt;double,double&gt; X[NX];
  X[0] = std::make_pair( 0., 6. );
  X[1] = std::make_pair( 0., 4. );
  <span class="keywordtype">double</span> x0[NX];
  x0[0] = 1.;
  x0[1] = 2.;
</pre></div><p>Then, an <a class="el" href="classmc_1_1NLPSBB.html" title="C++ class for global solution of nonconvex NLPs using spatial branch-and-bound.">mc::NLPSBB</a> object is defined---the default interval type mc::Interval is used here:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &quot;interval.h&quot;</span>
  <span class="keyword">typedef</span> mc::Interval I;
  <a class="code" href="classmc_1_1NLPSBB.html" title="C++ class for global solution of nonconvex NLPs using spatial branch-and-bound.">mc::NLPSBB&lt;I,NLP&gt;</a> pSBB = <span class="keyword">new</span> <a class="code" href="classmc_1_1NLPSBB.html" title="C++ class for global solution of nonconvex NLPs using spatial branch-and-bound.">mc::NLPSBB&lt;I,NLP&gt;</a>;
</pre></div><p>The NLP model is optimized as follows:</p>
<div class="fragment"><pre class="fragment">  std::cout &lt;&lt; pSBB;
  std::pair&lt;double,const double*&gt; optimum = pSBB-&gt;<a class="code" href="group__NLPSBB.html#ga19cb8c760ea0d2022454b2b53f803b34" title="Solve DO model -- return value is status.">solve</a>( X, x0 );
</pre></div><p>where the arguments of the NLPSBB::solve method are the variable bounds and the initial guess used by the local optimizer, respectively. The return value is of a pair, whose elements are the best solution found (incumbent) and the point at which it is attained. If the problem is infeasible, the first argument turns out to be equal to <a class="el" href="structmc_1_1SBB_1_1Options.html#acf789e405b95604a45e3d2c555ea67e1" title="Infinite.">mc::SBB::Options::INF</a> (for a minimize problem and -mc::SBB::Options::INF for a maximize problem) and the second one is a 0 pointer.</p>
<p>The following result is obtained for this problem:</p>
<div class="fragment"><pre class="fragment">
______________________________________________________________________

           GLOBAL NONLINEAR (NLP) OPTIMIZER IN MC++
______________________________________________________________________

SPATIAL BRANCH-AND-BOUND OPTIONS:

  ABSOLUTE CONVERGENCE TOLERANCE                            1.0e-03
  RELATIVE CONVERGENCE TOLERANCE                            1.0e-03
  MAXIMUM NUMBER OF ITERATIONS (PARTITIONS)                 NO LIMIT
  MAXIMUM CPU TIME (SEC)                                    1.0e+06
  DISPLAY LEVEL                                             2
  INTERNAL VALUE FOR INFINITY                               1.0e+20
  UPDATE ENTIRE TREE AFTER AN INCUMBENT IMPROVEMENT?        Y
  BRANCHING STRATEGY FOR NODE PARTITIONING                  OMEGA
  BRANCHING TOLERANCE FOR VARIABLE AT BOUND                 1.00e-03
  BRANCHING STRATEGY FOR VARIABLE SELECTION                 RGREL
  INITIALIZATION THRESHOLD IN RELIABILITY BRANCHING         1
  SCORE PARAMETER IN RELIABILITY BRANCHING                  0.17
  USE CONSTRAINT PROPAGATION?                               N
  USE REDUCTION CONSTRAINTS?                                N
  USE OPTIMIZATION-BASED DOMAIN REDUCTION?                  Y
  OPTIMIZATION-BASED REDUCTION MAX LOOPS                    4
  LOOP THRESHOLD FOR OPTIMIZATION-BASED REDUCTION           20%
  CUTS FROM TAYLOR MODELS                                   NONE
  ORDER OF TAYLOR MODEL                                     4
 _______________________________________________________________________

 INDEX STACK    CUMUL TIME        RELAX         INC   PARENT        UBD           LBD         ACTION  
     1     1  3.200200e-02  1.000000e+20 -1.000000e+20     0  6.666667e+00  5.000000e+00        FATHOM

#  NORMAL TERMINATION: 3.304207 CPU SEC  (LBD:64.8%  UBD:33.8%)
#  INCUMBENT VALUE:  6.666667e+00
#  INCUMBENT POINT:  6.000000e+00  6.666667e-01
#  INCUMBENT FOUND AT NODE: 1
#  TOTAL NUMBER OF NODES:   1
#  MAXIMUM NODES IN STACK:  0
</pre></div><p>The spatial B&amp;B method solves this problem in just 1 node. It turns out that the lower-bounding problem (local NLP solver) is a local solution with objective value equal to 5. However, the solution point of the upper-bounding problem (LP relaxation) turns out to be feasible with objective value equal to 6.667. In other word, we are lucky here that the solution of the relaxation at the root node is the global optimum. It follows that the root node is fathomed and the B&amp;B algorithm terminates. </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Thu Feb 13 2014 20:08:12 for GOLIB by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
